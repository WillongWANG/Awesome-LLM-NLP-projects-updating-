## Keyword extraction using TFIDF, TextRank, and LDA

### TFIDF  
```
pip install -r requirements.txt
# Unittests in test_tfidf.py, e.g.:
python /Applications/PyCharm.app/Contents/plugins/python/helpers/pycharm/_jb_unittest_runner.py --path .../tests/test_textrank.py 
```  
This program first calculates the offline idf for each word in all the files in ```tests/test_data/seg_data``` (tokenized text, with each line representing a document), and then keeps it fixed. It then calculates the tf for the words in ```words``` and finally computes and prints the tf-idf for each word.

### [TextRank](https://web.eecs.umich.edu/~mihalcea/papers/mihalcea.emnlp04.pdf) derived from PageRank  
```
Unittests in test_textrank.py
```
The program constructs an undirected weighted graph for TextRank using the ```words``` in ```content```, iteratively calculates, and prints the weight of each word node.

### Test and compare TFIDF & TextRank  
```
Unittests in test_keyword.py
```  
 Example results:  
```
#title = ''
#content = '新化县人民法院院长程海辉严重渎职官商勾结'
#top_k=2
TextRank:
['严重', '院长']
[('严重', 1.0), ('院长', 0.4975077840112475), ('渎职', 0.4965342188987376), ('新化县', 0.00038025478336170266), ('官商勾结', 0.0)]
TFIDF:
['渎职', '院长']
[('渎职', 0.4969813299576001), ('院长', 0.4969813299576001), ('严重', 0.4969813299576001), ('官商勾结', 0.4969813299576001), ('新化县', 0.4969813299576001)]
```  

### Latent Dirichlet allocation  
```
Unittests in test_topic_model.py
```  
Default settings:  
```
self.seg_data_file = './tests/test_data/sports_1000_seg.txt' # tokenized document
# In topic_model.py, num_topics=100, epoch=10
self.lda_model = LdaModel(corpus, num_topics=num_topics, id2word=self.lda_dict, passes=10)
```  
First train the LDA model, and calculate the topic distribution for documents and the topic distribution for words, performing similarity calculations (see [刘知远-基于文档主题结构的关键词抽取方法研究](http://www.nlpir.org/wordpress/attachments/2011/12/%E5%88%98%E7%9F%A5%E8%BF%9C-%E5%9F%BA%E4%BA%8E%E6%96%87%E6%A1%A3%E4%B8%BB%E9%A2%98%E7%BB%93%E6%9E%84%E7%9A%84%E5%85%B3%E9%94%AE%E8%AF%8D%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95%E7%A0%94%E7%A9%B6.pdf) 3.3). The similarities represent the words's weights, which are then used to extract the topic words.


## New word discovery using [SmoothNLP](https://zhuanlan.zhihu.com/p/80385615)

```
Unittests in test_word_discover.py
# data_path = 'tests/test_data/sports_1000.txt' # not tokenized
```

The richness of the character combinations and their left and right neighboring characters can be represented by Entropy:  
<div style="text-align: center; font-size: larger;">
$$\text{Entropy}(w) = - \sum_{w_n \in W_{\text{Neighbor}}} P(w_n|w) \log_2 P(w_n|w)$$
</div> 
To quantify the cohesion of character combinations, Pointwise Mutual Information (PMI) is used:  
$$\text{PMI} = p(x, y) \log_2 \frac{p(x, y)}{p(x)p(y)}$$   
To determine whether a character combination is a word, both the richness of neighboring characters and the internal cohesion must be considered.  
A score is calculated for each candidate word to represent its likelihood of being a word. To measure the richness of neighboring characters, we combine the left and right Entropy (LE, RE) into a statistical measure:  
$$\text{AMI} = \frac{1}{n} \log \frac{p(W)}{p(c_1) \cdots p(c_n)}$$  
Since the PMI value is influenced by the length of the candidate word (longer words tend to have higher PMI values), we use Average Mutual Information (AMI) as a measure of the word's internal cohesion:  
$$L(W) = \log \frac{LE \cdot e^{RE} + RE \cdot e^{LE}}{|LE - RE|}$$  
Candidate word score:  
$$\text{score} = \text{AMI} + L(W)$$  

New word examples:  
```
[('俱乐部', 21.968543575932912), ('已经', 21.80111710629627), ('冯潇霆', 20.744526405005132), ('NBA', 19.923965812582313), ('(微博)', 19.63150982319405), ('丁俊晖', 19.5695323675208), ('姚明', 19.444318206034303), ('非常', 19.333622750094015), ('——', 19.23958713512408), ('火箭', 18.93538089978142), ('开始', 18.830015655553282), ('高洪波', 18.825917177936194), ('诺维茨基', 18.82341571126907), ('甚至', 18.789651227007727), ('世界杯', 18.737681099097095), ('继续', 18.68541902419054), ('刘翔', 18.594751767963874), ('训练', 18.57661304926581), ('突破', 18.43532082248103), ('卡马乔', 18.4284756544054), ('可以', 18.29190327360309), ('似乎', 18.28554692389487), ('媒体', 18.254044084456268), ('参加', 18.24594426486662), ('记者', 18.232435559165737), ('帮助', 18.143410885282833), ('热火', 18.082899983342887), ('希望', 18.074114208663488), ('表示', 18.056770552199417), ('连续', 17.961908711876724), ('殷铁生', 17.90499683375794), ('亚洲杯', 17.884242153759967), ('应该', 17.841200917566937), ('葡萄牙', 17.788809447466704), ('进入', 17.77402009163304), ('裁判', 17.773958150542686), ('成为', 17.636489824374344), ('击败', 17.600500616783826), ('目前', 17.596773879211952), ('防守', 17.591550641492095), ('冠军', 17.54324419990591), ('今天', 17.529739526809852), ('西班牙', 17.41357093519679), ('刚刚', 17.41329419305991), ('无法', 17.40921482667155), ('正式', 17.363325181305804), ('交易', 17.210198299228498), ('最终', 17.182571825992426), ('教练', 17.175186465859362), ('需要', 17.138940702066662), ('易建联', 17.136990381379647), ('技术', 17.11742454557464), ('选择', 17.11166908789557), ('进攻', 17.108515761970498), ('直接', 17.104549304462402), ('保持', 17.090214211556), ('如何', 17.081114029004265), ('轻松', 17.03973455118698), ('欧洲', 17.028341089795333), ('双方', 17.022181051639755), ('必须', 17.011555820007743), ('调整', 17.0106327054983), ('蒿俊闵', 16.998189677709767), ('犯规', 16.979720510002565), ('通过', 16.953858025607623), ('邓卓翔', 16.93583053503478), ('雷霆', 16.896425008976124), ('恢复', 16.87261171520599), ('失误', 16.82708282395585), ('黄蜂', 16.78530265596236), ('叙利亚', 16.769154660033728), ('进行', 16.756212417509598), ('领先', 16.743289451871757), ('职业生涯', 16.73538495655177), ('计划', 16.72914566092909), ('梁文博', 16.721299635439), ('战胜', 16.715016396960674), ('猛龙', 16.70186177565308), ('休斯敦', 16.694092453304357), ('联盟', 16.680563912297448), ('再次', 16.679348309698742), ('外援', 16.662542172851666), ('什么', 16.661649256008275), ('几乎', 16.651857475228137), ('问题', 16.64602909214164), ('CBA', 16.604962463427224), ('主帅', 16.598828432959905), ('工作', 16.595548850651873), ('控制', 16.570197448606983), ('如此', 16.532740339168413), ('教练组', 16.517498064817868), ('怎么', 16.486923672625984), ('决定', 16.475114751344538), ('灰熊', 16.45703822276023), ('刘春明', 16.45127599704893), ('塞尔维亚', 16.446144894231686), ('准备', 16.44356589087278), ('执教', 16.438969202331567), ('选手', 16.398265373721514), ('卫冕冠军', 16.39690830458821), ('右侧', 16.385505575387874), ('状态', 16.37500889002236), ('郜林', 16.357951647266173), ('UCLA', 16.35424448994324), ('伤病', 16.34444620793991), ('逐渐', 16.328842189492626), ('自己', 16.328484331003303), ('考虑', 16.311680639267227), ('报道', 16.30656905769569), ('骑士', 16.29644089211959), ('主教练', 16.295295386961413), ('影响', 16.286963242866744), ('停摆', 16.27353645034098), ('阿根廷', 16.263770242403655), ('喜欢', 16.238965397428643), ('ESPN', 16.22078103241836), ('安东尼', 16.202851146854183), ('邓华德', 16.188345186109732), ('凭借', 16.18726104718425), ('新加坡', 16.183961069583376), ('酒店', 16.14977313099014), ('孙海平', 16.143235775043372), ('田径', 16.141404709955857), ('第二', 16.116358067950323), ('方面', 16.09902105070016), ('奇才', 16.054457374173207), ('乔丹', 16.025770340229123), ('虽然', 16.024672483916856), ('卡佩罗', 15.935590228742132), ('澳大利亚', 15.913356617346757), ('公牛', 15.906851667617468), ('疯狂', 15.904213208897568), ('仍然', 15.886175066181705), ('本赛季', 15.88183387452678), ('优势', 15.842951497501554), ('晋级', 15.838711242738821), ('杜威', 15.823411070621981), ('寻找', 15.821477845045113), ('意大利', 15.817277529708107), ('约翰逊', 15.811853486513591), ('魔术', 15.8113056194413), ('坚持', 15.683365493366846), ('认为', 15.678558633713852), ('很难', 15.67278863018269), ('更衣室', 15.666878833732582), ('小牛', 15.66227176217464), ('马刺', 15.645781437683539), ('迅速', 15.629388750293877), ('广厦', 15.62720089750361), ('安排', 15.596965585725979), ('终于', 15.555856050922609), ('配合', 15.541188028354721), ('纪录', 15.503636359607793), ('阵容', 15.48108079052769), ('依然', 15.475537026536333), ('完全', 15.46994924424821), ('组合', 15.460715752854558), ('张怡宁', 15.45781027882758), ('只能', 15.447052929442771), ('NCAA', 15.441145117977918), ('数据', 15.438469541133205), ('郭晶晶', 15.423131767436296), ('洛杉矶', 15.415082902757302), ('越来越', 15.41295421431941), ('发挥', 15.397149770366795), ('卡塔尔', 15.390530628653984), ('康复训练', 15.390440889811792), ('森林狼', 15.375165299518834), ('告诉', 15.334310892840001), ('因为', 15.330459435947354), ('拒绝', 15.298068621229183), ('水平', 15.290859177927164), ('土耳其', 15.288800841431524), ('卡戴珊', 15.280353771823169), ('担任', 15.26157814328802), ('或许', 15.261502945285605), ('最佳', 15.243664286419165), ('争夺', 15.243389100418952), ('内线', 15.235067721164565), ('作为', 15.20638285059862), ('荣昊', 15.188640378770884), ('谢杏芳', 15.186755040655374), ('朋友', 15.176175495189431), ('遭遇', 15.174346735842363), ('赵旭日', 15.155246225080731), ('之前', 15.145165674550746), ('运动员', 15.134154875551001), ('讨论', 15.119654889884483), ('昨天', 15.11044098286429), ('排名', 15.104740799349221), ('代表', 15.101330299906053), ('锻炼', 15.083238774944373), ('工作人员', 15.081876430754054), ('亨德利', 15.062243261570725), ('足协', 15.058459114997824), ('曾经', 15.049606501862236), ('贡献', 15.044096422165321), ('适应', 15.042666867800959), ('客场挑战', 15.028221669655272), ('右路', 15.024088244092582)]
```

